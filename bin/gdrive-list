#!/bin/bash
# Agent-friendly Google Drive list script  
# Usage: gdrive-list [folder]

# Configuration
REMOTE_NAME="${GDRIVE_REMOTE:-lisaross}"

# Check for .gdrive-project file for custom project name
if [ -f .gdrive-project ]; then
    PROJECT_NAME=$(cat .gdrive-project | tr -d '\n\r')
    FOLDER="${1:-ai-projects/$PROJECT_NAME}"
else
    FOLDER="${1:-ai-projects/$(basename "$PWD")}"
fi

echo "📂 Listing files in Google Drive folder '$FOLDER':"
echo ""

if rclone ls "$REMOTE_NAME:$FOLDER/" 2>/dev/null; then
    echo ""
    echo "📁 Subdirectories:"
    rclone lsd "$REMOTE_NAME:$FOLDER/" 2>/dev/null || echo "   (none)"
else
    echo "❌ Folder '$FOLDER' not found or empty"
    echo ""
    echo "💡 Available top-level folders:"
    rclone lsd "$REMOTE_NAME:" | head -10
fi
